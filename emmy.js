(function(){function f(a){if(a){for(var b in f.prototype)a[b]=f.prototype[b];return a}}function m(a,b,c,e){if(!a)return a;var d=a.on||a.addEventListener||a.addListener,g;g=e?m.wrap(c,e):c;b.split(/\s+/).forEach(function(c){if(d)if(t.freeze(a,"on"+c))d.call(a,c,g),t.b(a,"on"+c);else return a;B.on.call(a,c,g)});return a}function n(a,b,c){if(!a)return a;var e;if(void 0===c){var d=C(arguments,1),g=a.removeAll||a.removeAllListeners;g&&g.apply(a,d);e=a.a;if(!e)return;if(b)b.split(/\s+/).forEach(function(c){if(e[c])for(var b=
e[c].length;b--;)n(a,c,e[c][b])});else for(b in e)n(a,b);u.off.apply(a,d);return a}var f=a.off||a.removeEventListener||a.removeListener;b.split(/\s+/).forEach(function(b){if(f)if(v.freeze(a,"off"+b))f.call(a,b,c),v.b(a,"off"+b);else return a;u.off.call(a,b,c)});return a}function w(a,b,c,e){var d,g=b;a.nodeType||a===D||a===E?(b instanceof Event?g=b:(g=document.createEvent("CustomEvent"),g.initCustomEvent(b,e,!0,c)),d=a.dispatchEvent):r&&a instanceof r?(g=r.Event(b,c),g.detail=c,d=e?targte.trigger:
a.triggerHandler):d=a.emit||a.trigger||a.fire||a.dispatchEvent||a.raise;g=[g].concat(x(arguments,2));if(d&&y.freeze(a,"emit"+b))return d.apply(a,g),y.b(a,"emit"+b),a;F.emit.apply(a,g);return a}function s(a,b,c){if(a){var e=a.once||a.one||a.addOnceEventListener||a.addOnceListener,d;d=s.wrap(a,b,c,G);b.split(/\s+/).forEach(function(b){if(e&&z.freeze(a,"one"+b)){var f=e.call(a,b,c);z.b(a,"one"+b);return f}H(a,b,d)});return d}}function A(a){if(a){for(var b in h)a[b]=h[b];return a}}function p(a){return function(){a.apply(this,
[this].concat(I(arguments)));return this}}window.Emitter=A;var k,l;f.prototype.on=f.prototype.addEventListener=function(a,b){this.a=this.a||{};(this.a[a]=this.a[a]||[]).push(b);return this};f.prototype.once=function(a,b){function c(){e.off(a,c);b.apply(this,arguments)}var e=this;this.a=this.a||{};c.fn=b;this.on(a,c);return this};f.prototype.off=f.prototype.removeListener=f.prototype.removeEventListener=function(a,b){this.a=this.a||{};if(0==arguments.length)return this.a={},this;var c=this.a[a];if(!c)return this;
if(1==arguments.length)return delete this.a[a],this;for(var e,d=0;d<c.length;d++)if(e=c[d],e===b||e.fn===b){c.splice(d,1);break}return this};f.prototype.emit=function(a){this.a=this.a||{};var b=[].slice.call(arguments,1),c=this.a[a];if(c)for(var c=c.slice(0),e=0,d=c.length;e<d;++e)c[e].apply(this,b);return this};k={freeze:function(a,b){var c=q.get(a);if(c&&c[b])return!1;c||(c={},q.set(a,c));return c[b]=!0},b:function(a,b){var c=q.get(a);if(!c||!c[b])return!1;c[b]=null;return!0},isFrozen:function(a,
b){var c=q.get(a);return c&&c[b]}};var q=new WeakMap;l=l=function(a,b,c){var e=[],d=a.length;if(0===d)return e;b=0>b?Math.max(0,b+d):b||0;for(void 0!==c&&(d=0>c?c+d:c);d-- >b;)e[d-b]=a[d];return e};var t=k,B=f.prototype;m.wrap=function(a,b,c,e){function d(){if(e.apply(a,arguments))return c.apply(a,arguments)}d.fn=c;return d};var v=k,C=l,u=f.prototype,y=k,x=l,F=f.prototype,r="undefined"===typeof jQuery?void 0:jQuery,D="undefined"===typeof document?void 0:document,E="undefined"===typeof window?void 0:
window,z=k,H=m,G=n;s.wrap=function(a,b,c,e){function d(){e(a,b,d);c.apply(a,arguments)}d.fn=c;return d};var I=l,h=A.prototype=Object.create(f.prototype);h.on=p(m);h.once=p(s);h.off=p(n);h.emit=p(function(a,b){if(a){var c=arguments;if("string"===typeof b||b instanceof String)c=x(arguments,2),b.split(/\s+/).forEach(function(b){w.apply(this,[a,b].concat(c))});else return w.apply(this,c)}})})();
